function FEM = laplace_make_FEM_T2(FEM, mesh)
%HEAT_MAKE_FEM_T2
%
% Tiangang Cui, 31/Oct/2012

% tol = 1e-10;

FEM = laplace_make_FEM(FEM, mesh);

f1 = 1*exp(-0.5*sum((mesh.node-[0               ;0]             *ones(1,mesh.Nnode)).^2)/0.05^2)'/(2*pi*0.05^2) + ...
     1*exp(-0.5*sum((mesh.node-[max(mesh.gx)    ;0]             *ones(1,mesh.Nnode)).^2)/0.05^2)'/(2*pi*0.05^2) + ...
     1*exp(-0.5*sum((mesh.node-[max(mesh.gx)    ;max(mesh.gy)]  *ones(1,mesh.Nnode)).^2)/0.05^2)'/(2*pi*0.05^2) + ...
     1*exp(-0.5*sum((mesh.node-[0               ;max(mesh.gy)]  *ones(1,mesh.Nnode)).^2)/0.05^2)'/(2*pi*0.05^2) + ... % four corners, 1
     1*exp(-0.5*sum((mesh.node-[0               ;max(mesh.gy)/2]*ones(1,mesh.Nnode)).^2)/0.05^2)'/(2*pi*0.05^2) + ...
     1*exp(-0.5*sum((mesh.node-[max(mesh.gx)    ;max(mesh.gy)/2]*ones(1,mesh.Nnode)).^2)/0.05^2)'/(2*pi*0.05^2) + ... % left an dright boundary, 1
     1*exp(-0.5*sum((mesh.node-[max(mesh.gx)/6  ;0]             *ones(1,mesh.Nnode)).^2)/0.05^2)'/(2*pi*0.05^2) + ...
     1*exp(-0.5*sum((mesh.node-[max(mesh.gx)*2/6;0]             *ones(1,mesh.Nnode)).^2)/0.05^2)'/(2*pi*0.05^2) + ...
     1*exp(-0.5*sum((mesh.node-[max(mesh.gx)*3/6;0]             *ones(1,mesh.Nnode)).^2)/0.05^2)'/(2*pi*0.05^2) + ...
     1*exp(-0.5*sum((mesh.node-[max(mesh.gx)*4/6;0]             *ones(1,mesh.Nnode)).^2)/0.05^2)'/(2*pi*0.05^2) + ...
     1*exp(-0.5*sum((mesh.node-[max(mesh.gx)*5/6;0]             *ones(1,mesh.Nnode)).^2)/0.05^2)'/(2*pi*0.05^2) + ... % bottom boundary, 3
     1*exp(-0.5*sum((mesh.node-[max(mesh.gx)/6  ;max(mesh.gy)]  *ones(1,mesh.Nnode)).^2)/0.05^2)'/(2*pi*0.05^2) + ...
     1*exp(-0.5*sum((mesh.node-[max(mesh.gx)*2/6;max(mesh.gy)]  *ones(1,mesh.Nnode)).^2)/0.05^2)'/(2*pi*0.05^2) + ...
     1*exp(-0.5*sum((mesh.node-[max(mesh.gx)*3/6;max(mesh.gy)]  *ones(1,mesh.Nnode)).^2)/0.05^2)'/(2*pi*0.05^2) + ...
     1*exp(-0.5*sum((mesh.node-[max(mesh.gx)*4/6;max(mesh.gy)]  *ones(1,mesh.Nnode)).^2)/0.05^2)'/(2*pi*0.05^2) + ...
     1*exp(-0.5*sum((mesh.node-[max(mesh.gx)*5/6;max(mesh.gy)]  *ones(1,mesh.Nnode)).^2)/0.05^2)'/(2*pi*0.05^2);      % top boundary, 3

f2 = 4*exp(-0.5*sum((mesh.node-[max(mesh.gx)/3  ;max(mesh.gy)/2]*ones(1,mesh.Nnode)).^2)/0.05^2)'/(2*pi*0.05^2) + ...
     4*exp(-0.5*sum((mesh.node-[max(mesh.gx)*2/3;max(mesh.gy)/2]*ones(1,mesh.Nnode)).^2)/0.05^2)'/(2*pi*0.05^2);

f = f1 - f2;

FEM.fs = FEM.M*f;

end